.include "macros.inc"

.section .text, "ax"  # 0x80006940 - 0x80418B80
.global "EUARTInit"
"EUARTInit":
/* 80370A28 0036C6C8  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 80370A2C 0036C6CC  7C 08 02 A6 */	mflr r0
/* 80370A30 0036C6D0  90 01 00 24 */	stw r0, 0x24(r1)
/* 80370A34 0036C6D4  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 80370A38 0036C6D8  80 0D C4 60 */	lwz r0, "__EUARTInitialized"-_SDA_BASE_(r13)
/* 80370A3C 0036C6DC  2C 00 00 00 */	cmpwi r0, 0
/* 80370A40 0036C6E0  41 82 00 0C */	beq lbl_80370A4C
/* 80370A44 0036C6E4  38 60 00 01 */	li r3, 1
/* 80370A48 0036C6E8  48 00 00 C8 */	b lbl_80370B10
lbl_80370A4C:
/* 80370A4C 0036C6EC  48 06 96 FD */	bl "OSGetConsoleType"
/* 80370A50 0036C6F0  54 60 00 C7 */	rlwinm. r0, r3, 0, 3, 3
/* 80370A54 0036C6F4  40 82 00 14 */	bne lbl_80370A68
/* 80370A58 0036C6F8  38 00 00 02 */	li r0, 2
/* 80370A5C 0036C6FC  38 60 00 00 */	li r3, 0
/* 80370A60 0036C700  90 0D C4 64 */	stw r0, "__EUARTLastErrorCode"-_SDA_BASE_(r13)
/* 80370A64 0036C704  48 00 00 AC */	b lbl_80370B10
lbl_80370A68:
/* 80370A68 0036C708  48 06 F9 F5 */	bl "__RAS_OSDisableInterrupts_begin"
/* 80370A6C 0036C70C  38 00 00 F2 */	li r0, 0xf2
/* 80370A70 0036C710  7C 7F 1B 78 */	mr r31, r3
/* 80370A74 0036C714  98 01 00 08 */	stb r0, 8(r1)
/* 80370A78 0036C718  38 C1 00 08 */	addi r6, r1, 8
/* 80370A7C 0036C71C  38 60 00 00 */	li r3, 0
/* 80370A80 0036C720  38 80 00 01 */	li r4, 1
/* 80370A84 0036C724  3C A0 B0 00 */	lis r5, 0xb000
/* 80370A88 0036C728  38 E0 00 01 */	li r7, 1
/* 80370A8C 0036C72C  48 00 1E D5 */	bl "EXIWriteReg"
/* 80370A90 0036C730  2C 03 00 00 */	cmpwi r3, 0
/* 80370A94 0036C734  40 82 00 1C */	bne lbl_80370AB0
/* 80370A98 0036C738  38 00 00 05 */	li r0, 5
/* 80370A9C 0036C73C  7F E3 FB 78 */	mr r3, r31
/* 80370AA0 0036C740  90 0D C4 64 */	stw r0, "__EUARTLastErrorCode"-_SDA_BASE_(r13)
/* 80370AA4 0036C744  48 06 F9 E1 */	bl "OSRestoreInterrupts"
/* 80370AA8 0036C748  38 60 00 00 */	li r3, 0
/* 80370AAC 0036C74C  48 00 00 64 */	b lbl_80370B10
lbl_80370AB0:
/* 80370AB0 0036C750  38 00 00 F3 */	li r0, 0xf3
/* 80370AB4 0036C754  38 C1 00 08 */	addi r6, r1, 8
/* 80370AB8 0036C758  98 01 00 08 */	stb r0, 8(r1)
/* 80370ABC 0036C75C  38 60 00 00 */	li r3, 0
/* 80370AC0 0036C760  38 80 00 01 */	li r4, 1
/* 80370AC4 0036C764  3C A0 B0 00 */	lis r5, 0xb000
/* 80370AC8 0036C768  38 E0 00 01 */	li r7, 1
/* 80370ACC 0036C76C  48 00 1E 95 */	bl "EXIWriteReg"
/* 80370AD0 0036C770  2C 03 00 00 */	cmpwi r3, 0
/* 80370AD4 0036C774  40 82 00 1C */	bne lbl_80370AF0
/* 80370AD8 0036C778  38 00 00 05 */	li r0, 5
/* 80370ADC 0036C77C  7F E3 FB 78 */	mr r3, r31
/* 80370AE0 0036C780  90 0D C4 64 */	stw r0, "__EUARTLastErrorCode"-_SDA_BASE_(r13)
/* 80370AE4 0036C784  48 06 F9 A1 */	bl "OSRestoreInterrupts"
/* 80370AE8 0036C788  38 60 00 00 */	li r3, 0
/* 80370AEC 0036C78C  48 00 00 24 */	b lbl_80370B10
lbl_80370AF0:
/* 80370AF0 0036C790  7F E3 FB 78 */	mr r3, r31
/* 80370AF4 0036C794  48 06 F9 91 */	bl "OSRestoreInterrupts"
/* 80370AF8 0036C798  38 00 00 00 */	li r0, 0
/* 80370AFC 0036C79C  38 60 00 01 */	li r3, 1
/* 80370B00 0036C7A0  90 6D C4 60 */	stw r3, "__EUARTInitialized"-_SDA_BASE_(r13)
/* 80370B04 0036C7A4  38 60 00 01 */	li r3, 1
/* 80370B08 0036C7A8  90 0D C4 64 */	stw r0, "__EUARTLastErrorCode"-_SDA_BASE_(r13)
/* 80370B0C 0036C7AC  90 0D C4 68 */	stw r0, "__EUARTSendStop"-_SDA_BASE_(r13)
lbl_80370B10:
/* 80370B10 0036C7B0  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80370B14 0036C7B4  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 80370B18 0036C7B8  7C 08 03 A6 */	mtlr r0
/* 80370B1C 0036C7BC  38 21 00 20 */	addi r1, r1, 0x20
/* 80370B20 0036C7C0  4E 80 00 20 */	blr

.global "InitializeUART"
"InitializeUART":
/* 80370B24 0036C7C4  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 80370B28 0036C7C8  7C 08 02 A6 */	mflr r0
/* 80370B2C 0036C7CC  90 01 00 14 */	stw r0, 0x14(r1)
/* 80370B30 0036C7D0  48 06 96 19 */	bl "OSGetConsoleType"
/* 80370B34 0036C7D4  54 60 00 C7 */	rlwinm. r0, r3, 0, 3, 3
/* 80370B38 0036C7D8  40 82 00 14 */	bne lbl_80370B4C
/* 80370B3C 0036C7DC  38 00 00 00 */	li r0, 0
/* 80370B40 0036C7E0  38 60 00 02 */	li r3, 2
/* 80370B44 0036C7E4  90 0D C4 6C */	stw r0, "Enabled"-_SDA_BASE_(r13)
/* 80370B48 0036C7E8  48 00 00 14 */	b lbl_80370B5C
lbl_80370B4C:
/* 80370B4C 0036C7EC  3C 80 A5 FF */	lis r4, 0xA5FF005A@ha
/* 80370B50 0036C7F0  38 60 00 00 */	li r3, 0
/* 80370B54 0036C7F4  38 04 00 5A */	addi r0, r4, 0xA5FF005A@l
/* 80370B58 0036C7F8  90 0D C4 6C */	stw r0, "Enabled"-_SDA_BASE_(r13)
lbl_80370B5C:
/* 80370B5C 0036C7FC  80 01 00 14 */	lwz r0, 0x14(r1)
/* 80370B60 0036C800  7C 08 03 A6 */	mtlr r0
/* 80370B64 0036C804  38 21 00 10 */	addi r1, r1, 0x10
/* 80370B68 0036C808  4E 80 00 20 */	blr

.global "WriteUARTN"
"WriteUARTN":
/* 80370B6C 0036C80C  94 21 FF D0 */	stwu r1, -0x30(r1)
/* 80370B70 0036C810  7C 08 02 A6 */	mflr r0
/* 80370B74 0036C814  90 01 00 34 */	stw r0, 0x34(r1)
/* 80370B78 0036C818  39 61 00 30 */	addi r11, r1, 0x30
/* 80370B7C 0036C81C  48 09 E7 F5 */	bl "_savegpr_26"
/* 80370B80 0036C820  80 AD C4 6C */	lwz r5, "Enabled"-_SDA_BASE_(r13)
/* 80370B84 0036C824  7C 7E 1B 78 */	mr r30, r3
/* 80370B88 0036C828  7C 9F 23 78 */	mr r31, r4
/* 80370B8C 0036C82C  3C 05 5A 01 */	addis r0, r5, 0x5a01
/* 80370B90 0036C830  28 00 00 5A */	cmplwi r0, 0x5a
/* 80370B94 0036C834  41 82 00 0C */	beq lbl_80370BA0
/* 80370B98 0036C838  38 60 00 02 */	li r3, 2
/* 80370B9C 0036C83C  48 00 01 E4 */	b lbl_80370D80
lbl_80370BA0:
/* 80370BA0 0036C840  80 0D C4 60 */	lwz r0, "__EUARTInitialized"-_SDA_BASE_(r13)
/* 80370BA4 0036C844  2C 00 00 00 */	cmpwi r0, 0
/* 80370BA8 0036C848  40 82 00 18 */	bne lbl_80370BC0
/* 80370BAC 0036C84C  4B FF FE 7D */	bl "EUARTInit"
/* 80370BB0 0036C850  2C 03 00 00 */	cmpwi r3, 0
/* 80370BB4 0036C854  40 82 00 0C */	bne lbl_80370BC0
/* 80370BB8 0036C858  38 60 00 02 */	li r3, 2
/* 80370BBC 0036C85C  48 00 01 C4 */	b lbl_80370D80
lbl_80370BC0:
/* 80370BC0 0036C860  80 0D C4 60 */	lwz r0, "__EUARTInitialized"-_SDA_BASE_(r13)
/* 80370BC4 0036C864  2C 00 00 00 */	cmpwi r0, 0
/* 80370BC8 0036C868  40 82 00 14 */	bne lbl_80370BDC
/* 80370BCC 0036C86C  38 00 00 01 */	li r0, 1
/* 80370BD0 0036C870  38 60 00 02 */	li r3, 2
/* 80370BD4 0036C874  90 0D C4 64 */	stw r0, "__EUARTLastErrorCode"-_SDA_BASE_(r13)
/* 80370BD8 0036C878  48 00 01 A8 */	b lbl_80370D80
lbl_80370BDC:
/* 80370BDC 0036C87C  38 60 00 00 */	li r3, 0
/* 80370BE0 0036C880  38 80 00 01 */	li r4, 1
/* 80370BE4 0036C884  38 A0 00 00 */	li r5, 0
/* 80370BE8 0036C888  48 00 14 9D */	bl "EXILock"
/* 80370BEC 0036C88C  2C 03 00 00 */	cmpwi r3, 0
/* 80370BF0 0036C890  40 82 00 0C */	bne lbl_80370BFC
/* 80370BF4 0036C894  38 60 00 00 */	li r3, 0
/* 80370BF8 0036C898  48 00 01 88 */	b lbl_80370D80
lbl_80370BFC:
/* 80370BFC 0036C89C  7F C4 F3 78 */	mr r4, r30
/* 80370C00 0036C8A0  38 60 00 0D */	li r3, 0xd
/* 80370C04 0036C8A4  48 00 00 18 */	b lbl_80370C1C
lbl_80370C08:
/* 80370C08 0036C8A8  88 04 00 00 */	lbz r0, 0(r4)
/* 80370C0C 0036C8AC  2C 00 00 0A */	cmpwi r0, 0xa
/* 80370C10 0036C8B0  40 82 00 08 */	bne lbl_80370C18
/* 80370C14 0036C8B4  98 64 00 00 */	stb r3, 0(r4)
lbl_80370C18:
/* 80370C18 0036C8B8  38 84 00 01 */	addi r4, r4, 1
lbl_80370C1C:
/* 80370C1C 0036C8BC  7C 1E 20 50 */	subf r0, r30, r4
/* 80370C20 0036C8C0  7C 00 F8 40 */	cmplw r0, r31
/* 80370C24 0036C8C4  41 80 FF E4 */	blt lbl_80370C08
/* 80370C28 0036C8C8  3C 60 B0 00 */	lis r3, 0xB0000100@ha
/* 80370C2C 0036C8CC  83 82 A5 90 */	lwz r28, "__EXIFreq"-_SDA2_BASE_(r2)
/* 80370C30 0036C8D0  38 03 01 00 */	addi r0, r3, 0xB0000100@l
/* 80370C34 0036C8D4  3B 40 00 00 */	li r26, 0
/* 80370C38 0036C8D8  90 01 00 14 */	stw r0, 0x14(r1)
/* 80370C3C 0036C8DC  3F A0 30 00 */	lis r29, 0x3000
/* 80370C40 0036C8E0  48 00 01 2C */	b lbl_80370D6C
lbl_80370C44:
/* 80370C44 0036C8E4  7F 85 E3 78 */	mr r5, r28
/* 80370C48 0036C8E8  38 60 00 00 */	li r3, 0
/* 80370C4C 0036C8EC  38 80 00 01 */	li r4, 1
/* 80370C50 0036C8F0  48 00 0C A1 */	bl "EXISelect"
/* 80370C54 0036C8F4  2C 03 00 00 */	cmpwi r3, 0
/* 80370C58 0036C8F8  40 82 00 0C */	bne lbl_80370C64
/* 80370C5C 0036C8FC  3B 60 FF FF */	li r27, -1
/* 80370C60 0036C900  48 00 00 60 */	b lbl_80370CC0
lbl_80370C64:
/* 80370C64 0036C904  38 1D 01 00 */	addi r0, r29, 0x100
/* 80370C68 0036C908  38 81 00 08 */	addi r4, r1, 8
/* 80370C6C 0036C90C  90 01 00 08 */	stw r0, 8(r1)
/* 80370C70 0036C910  38 60 00 00 */	li r3, 0
/* 80370C74 0036C914  38 A0 00 04 */	li r5, 4
/* 80370C78 0036C918  38 C0 00 01 */	li r6, 1
/* 80370C7C 0036C91C  38 E0 00 00 */	li r7, 0
/* 80370C80 0036C920  48 00 02 09 */	bl "EXIImm"
/* 80370C84 0036C924  38 60 00 00 */	li r3, 0
/* 80370C88 0036C928  48 00 06 19 */	bl "EXISync"
/* 80370C8C 0036C92C  38 81 00 0C */	addi r4, r1, 0xc
/* 80370C90 0036C930  38 60 00 00 */	li r3, 0
/* 80370C94 0036C934  38 A0 00 04 */	li r5, 4
/* 80370C98 0036C938  38 C0 00 00 */	li r6, 0
/* 80370C9C 0036C93C  38 E0 00 00 */	li r7, 0
/* 80370CA0 0036C940  48 00 01 E9 */	bl "EXIImm"
/* 80370CA4 0036C944  38 60 00 00 */	li r3, 0
/* 80370CA8 0036C948  48 00 05 F9 */	bl "EXISync"
/* 80370CAC 0036C94C  38 60 00 00 */	li r3, 0
/* 80370CB0 0036C950  48 00 0D 71 */	bl "EXIDeselect"
/* 80370CB4 0036C954  80 01 00 0C */	lwz r0, 0xc(r1)
/* 80370CB8 0036C958  54 00 46 BE */	rlwinm r0, r0, 8, 0x1a, 0x1f
/* 80370CBC 0036C95C  23 60 00 20 */	subfic r27, r0, 0x20
lbl_80370CC0:
/* 80370CC0 0036C960  2C 1B 00 00 */	cmpwi r27, 0
/* 80370CC4 0036C964  40 80 00 0C */	bge lbl_80370CD0
/* 80370CC8 0036C968  3B 40 00 03 */	li r26, 3
/* 80370CCC 0036C96C  48 00 00 A8 */	b lbl_80370D74
lbl_80370CD0:
/* 80370CD0 0036C970  2C 1B 00 20 */	cmpwi r27, 0x20
/* 80370CD4 0036C974  40 82 00 98 */	bne lbl_80370D6C
/* 80370CD8 0036C978  7F 85 E3 78 */	mr r5, r28
/* 80370CDC 0036C97C  38 60 00 00 */	li r3, 0
/* 80370CE0 0036C980  38 80 00 01 */	li r4, 1
/* 80370CE4 0036C984  48 00 0C 0D */	bl "EXISelect"
/* 80370CE8 0036C988  2C 03 00 00 */	cmpwi r3, 0
/* 80370CEC 0036C98C  40 82 00 0C */	bne lbl_80370CF8
/* 80370CF0 0036C990  3B 40 00 03 */	li r26, 3
/* 80370CF4 0036C994  48 00 00 80 */	b lbl_80370D74
lbl_80370CF8:
/* 80370CF8 0036C998  38 81 00 14 */	addi r4, r1, 0x14
/* 80370CFC 0036C99C  38 60 00 00 */	li r3, 0
/* 80370D00 0036C9A0  38 A0 00 04 */	li r5, 4
/* 80370D04 0036C9A4  38 C0 00 01 */	li r6, 1
/* 80370D08 0036C9A8  38 E0 00 00 */	li r7, 0
/* 80370D0C 0036C9AC  48 00 01 7D */	bl "EXIImm"
/* 80370D10 0036C9B0  38 60 00 00 */	li r3, 0
/* 80370D14 0036C9B4  48 00 05 8D */	bl "EXISync"
/* 80370D18 0036C9B8  48 00 00 3C */	b lbl_80370D54
lbl_80370D1C:
/* 80370D1C 0036C9BC  88 1E 00 00 */	lbz r0, 0(r30)
/* 80370D20 0036C9C0  38 81 00 10 */	addi r4, r1, 0x10
/* 80370D24 0036C9C4  38 60 00 00 */	li r3, 0
/* 80370D28 0036C9C8  38 A0 00 04 */	li r5, 4
/* 80370D2C 0036C9CC  54 00 C0 0E */	slwi r0, r0, 0x18
/* 80370D30 0036C9D0  38 C0 00 01 */	li r6, 1
/* 80370D34 0036C9D4  90 01 00 10 */	stw r0, 0x10(r1)
/* 80370D38 0036C9D8  38 E0 00 00 */	li r7, 0
/* 80370D3C 0036C9DC  48 00 01 4D */	bl "EXIImm"
/* 80370D40 0036C9E0  38 60 00 00 */	li r3, 0
/* 80370D44 0036C9E4  48 00 05 5D */	bl "EXISync"
/* 80370D48 0036C9E8  3B DE 00 01 */	addi r30, r30, 1
/* 80370D4C 0036C9EC  3B 7B FF FF */	addi r27, r27, -1
/* 80370D50 0036C9F0  3B FF FF FF */	addi r31, r31, -1
lbl_80370D54:
/* 80370D54 0036C9F4  2C 1B 00 00 */	cmpwi r27, 0
/* 80370D58 0036C9F8  40 81 00 0C */	ble lbl_80370D64
/* 80370D5C 0036C9FC  2C 1F 00 00 */	cmpwi r31, 0
/* 80370D60 0036CA00  40 82 FF BC */	bne lbl_80370D1C
lbl_80370D64:
/* 80370D64 0036CA04  38 60 00 00 */	li r3, 0
/* 80370D68 0036CA08  48 00 0C B9 */	bl "EXIDeselect"
lbl_80370D6C:
/* 80370D6C 0036CA0C  2C 1F 00 00 */	cmpwi r31, 0
/* 80370D70 0036CA10  40 82 FE D4 */	bne lbl_80370C44
lbl_80370D74:
/* 80370D74 0036CA14  38 60 00 00 */	li r3, 0
/* 80370D78 0036CA18  48 00 14 09 */	bl "EXIUnlock"
/* 80370D7C 0036CA1C  7F 43 D3 78 */	mr r3, r26
lbl_80370D80:
/* 80370D80 0036CA20  39 61 00 30 */	addi r11, r1, 0x30
/* 80370D84 0036CA24  48 09 E6 39 */	bl "_restgpr_26"
/* 80370D88 0036CA28  80 01 00 34 */	lwz r0, 0x34(r1)
/* 80370D8C 0036CA2C  7C 08 03 A6 */	mtlr r0
/* 80370D90 0036CA30  38 21 00 30 */	addi r1, r1, 0x30
/* 80370D94 0036CA34  4E 80 00 20 */	blr

.section .sbss, "wa"  # 0x805d79c0 - 0x805d9220
.global "__EUARTInitialized"
"__EUARTInitialized":
	.skip 0x4
.global "__EUARTLastErrorCode"
"__EUARTLastErrorCode":
	.skip 0x4
.global "__EUARTSendStop"
"__EUARTSendStop":
	.skip 0x4
.global "Enabled"
"Enabled":
	.skip 0x4
