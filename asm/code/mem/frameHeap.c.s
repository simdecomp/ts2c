.include "macros.inc"

.section .text, "ax"  # 0x80006940 - 0x80418B80
.global "MEMCreateFrmHeapEx"
"MEMCreateFrmHeapEx":
/* 803D38E0 003CF580  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 803D38E4 003CF584  7C 08 02 A6 */	mflr r0
/* 803D38E8 003CF588  7C 84 1A 14 */	add r4, r4, r3
/* 803D38EC 003CF58C  90 01 00 14 */	stw r0, 0x14(r1)
/* 803D38F0 003CF590  38 03 00 03 */	addi r0, r3, 3
/* 803D38F4 003CF594  54 86 00 3A */	rlwinm r6, r4, 0, 0, 0x1d
/* 803D38F8 003CF598  93 E1 00 0C */	stw r31, 0xc(r1)
/* 803D38FC 003CF59C  54 1F 00 3A */	rlwinm r31, r0, 0, 0, 0x1d
/* 803D3900 003CF5A0  7C 1F 30 40 */	cmplw r31, r6
/* 803D3904 003CF5A4  41 81 00 10 */	bgt lbl_803D3914
/* 803D3908 003CF5A8  7C 1F 30 50 */	subf r0, r31, r6
/* 803D390C 003CF5AC  28 00 00 48 */	cmplwi r0, 0x48
/* 803D3910 003CF5B0  40 80 00 0C */	bge lbl_803D391C
lbl_803D3914:
/* 803D3914 003CF5B4  38 60 00 00 */	li r3, 0
/* 803D3918 003CF5B8  48 00 00 38 */	b lbl_803D3950
lbl_803D391C:
/* 803D391C 003CF5BC  3C 80 46 52 */	lis r4, 0x46524D48@ha
/* 803D3920 003CF5C0  7C A7 2B 78 */	mr r7, r5
/* 803D3924 003CF5C4  7F E3 FB 78 */	mr r3, r31
/* 803D3928 003CF5C8  38 BF 00 48 */	addi r5, r31, 0x48
/* 803D392C 003CF5CC  38 84 4D 48 */	addi r4, r4, 0x46524D48@l
/* 803D3930 003CF5D0  4B FF F5 19 */	bl "MEMiInitHeapHead"
/* 803D3934 003CF5D4  80 9F 00 18 */	lwz r4, 0x18(r31)
/* 803D3938 003CF5D8  38 00 00 00 */	li r0, 0
/* 803D393C 003CF5DC  7F E3 FB 78 */	mr r3, r31
/* 803D3940 003CF5E0  90 9F 00 3C */	stw r4, 0x3c(r31)
/* 803D3944 003CF5E4  80 9F 00 1C */	lwz r4, 0x1c(r31)
/* 803D3948 003CF5E8  90 9F 00 40 */	stw r4, 0x40(r31)
/* 803D394C 003CF5EC  90 1F 00 44 */	stw r0, 0x44(r31)
lbl_803D3950:
/* 803D3950 003CF5F0  80 01 00 14 */	lwz r0, 0x14(r1)
/* 803D3954 003CF5F4  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 803D3958 003CF5F8  7C 08 03 A6 */	mtlr r0
/* 803D395C 003CF5FC  38 21 00 10 */	addi r1, r1, 0x10
/* 803D3960 003CF600  4E 80 00 20 */	blr 

.global "MEMDestroyFrmHeap"
"MEMDestroyFrmHeap":
/* 803D3964 003CF604  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 803D3968 003CF608  7C 08 02 A6 */	mflr r0
/* 803D396C 003CF60C  90 01 00 14 */	stw r0, 0x14(r1)
/* 803D3970 003CF610  93 E1 00 0C */	stw r31, 0xc(r1)
/* 803D3974 003CF614  7C 7F 1B 78 */	mr r31, r3
/* 803D3978 003CF618  4B FF F6 91 */	bl "MEMiFinalizeHeap"
/* 803D397C 003CF61C  7F E3 FB 78 */	mr r3, r31
/* 803D3980 003CF620  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 803D3984 003CF624  80 01 00 14 */	lwz r0, 0x14(r1)
/* 803D3988 003CF628  7C 08 03 A6 */	mtlr r0
/* 803D398C 003CF62C  38 21 00 10 */	addi r1, r1, 0x10
/* 803D3990 003CF630  4E 80 00 20 */	blr 

.global "MEMAllocFromFrmHeapEx"
"MEMAllocFromFrmHeapEx":
/* 803D3994 003CF634  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 803D3998 003CF638  7C 08 02 A6 */	mflr r0
/* 803D399C 003CF63C  2C 04 00 00 */	cmpwi r4, 0
/* 803D39A0 003CF640  90 01 00 24 */	stw r0, 0x24(r1)
/* 803D39A4 003CF644  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 803D39A8 003CF648  7C 7F 1B 78 */	mr r31, r3
/* 803D39AC 003CF64C  93 C1 00 18 */	stw r30, 0x18(r1)
/* 803D39B0 003CF650  7C 9E 23 78 */	mr r30, r4
/* 803D39B4 003CF654  93 A1 00 14 */	stw r29, 0x14(r1)
/* 803D39B8 003CF658  7C BD 2B 78 */	mr r29, r5
/* 803D39BC 003CF65C  40 82 00 08 */	bne lbl_803D39C4
/* 803D39C0 003CF660  3B C0 00 01 */	li r30, 1
lbl_803D39C4:
/* 803D39C4 003CF664  80 03 00 38 */	lwz r0, 0x38(r3)
/* 803D39C8 003CF668  38 9E 00 03 */	addi r4, r30, 3
/* 803D39CC 003CF66C  54 9E 00 3A */	rlwinm r30, r4, 0, 0, 0x1d
/* 803D39D0 003CF670  54 00 07 7B */	rlwinm. r0, r0, 0, 0x1d, 0x1d
/* 803D39D4 003CF674  41 82 00 0C */	beq lbl_803D39E0
/* 803D39D8 003CF678  38 63 00 20 */	addi r3, r3, 0x20
/* 803D39DC 003CF67C  48 00 DC 6D */	bl "OSLockMutex"
lbl_803D39E0:
/* 803D39E0 003CF680  2C 1D 00 00 */	cmpwi r29, 0
/* 803D39E4 003CF684  41 80 00 54 */	blt lbl_803D3A38
/* 803D39E8 003CF688  80 7F 00 3C */	lwz r3, 0x3c(r31)
/* 803D39EC 003CF68C  38 1D FF FF */	addi r0, r29, -1
/* 803D39F0 003CF690  7C 05 00 F8 */	nor r5, r0, r0
/* 803D39F4 003CF694  80 1F 00 40 */	lwz r0, 0x40(r31)
/* 803D39F8 003CF698  7C 9D 1A 14 */	add r4, r29, r3
/* 803D39FC 003CF69C  38 84 FF FF */	addi r4, r4, -1
/* 803D3A00 003CF6A0  7C BD 20 38 */	and r29, r5, r4
/* 803D3A04 003CF6A4  7F DE EA 14 */	add r30, r30, r29
/* 803D3A08 003CF6A8  7C 1E 00 40 */	cmplw r30, r0
/* 803D3A0C 003CF6AC  40 81 00 0C */	ble lbl_803D3A18
/* 803D3A10 003CF6B0  3B A0 00 00 */	li r29, 0
/* 803D3A14 003CF6B4  48 00 00 6C */	b lbl_803D3A80
lbl_803D3A18:
/* 803D3A18 003CF6B8  80 1F 00 38 */	lwz r0, 0x38(r31)
/* 803D3A1C 003CF6BC  7C A3 F0 50 */	subf r5, r3, r30
/* 803D3A20 003CF6C0  54 00 07 FF */	clrlwi. r0, r0, 0x1f
/* 803D3A24 003CF6C4  41 82 00 0C */	beq lbl_803D3A30
/* 803D3A28 003CF6C8  38 80 00 00 */	li r4, 0
/* 803D3A2C 003CF6CC  4B C3 0A 11 */	bl "memset"
lbl_803D3A30:
/* 803D3A30 003CF6D0  93 DF 00 3C */	stw r30, 0x3c(r31)
/* 803D3A34 003CF6D4  48 00 00 4C */	b lbl_803D3A80
lbl_803D3A38:
/* 803D3A38 003CF6D8  80 BF 00 40 */	lwz r5, 0x40(r31)
/* 803D3A3C 003CF6DC  20 1D FF FF */	subfic r0, r29, -1
/* 803D3A40 003CF6E0  7C 04 00 F8 */	nor r4, r0, r0
/* 803D3A44 003CF6E4  80 1F 00 3C */	lwz r0, 0x3c(r31)
/* 803D3A48 003CF6E8  7C 7E 28 50 */	subf r3, r30, r5
/* 803D3A4C 003CF6EC  7C 9D 18 38 */	and r29, r4, r3
/* 803D3A50 003CF6F0  7C 1D 00 40 */	cmplw r29, r0
/* 803D3A54 003CF6F4  40 80 00 0C */	bge lbl_803D3A60
/* 803D3A58 003CF6F8  3B A0 00 00 */	li r29, 0
/* 803D3A5C 003CF6FC  48 00 00 24 */	b lbl_803D3A80
lbl_803D3A60:
/* 803D3A60 003CF700  80 1F 00 38 */	lwz r0, 0x38(r31)
/* 803D3A64 003CF704  7C BD 28 50 */	subf r5, r29, r5
/* 803D3A68 003CF708  54 00 07 FF */	clrlwi. r0, r0, 0x1f
/* 803D3A6C 003CF70C  41 82 00 10 */	beq lbl_803D3A7C
/* 803D3A70 003CF710  7F A3 EB 78 */	mr r3, r29
/* 803D3A74 003CF714  38 80 00 00 */	li r4, 0
/* 803D3A78 003CF718  4B C3 09 C5 */	bl "memset"
lbl_803D3A7C:
/* 803D3A7C 003CF71C  93 BF 00 40 */	stw r29, 0x40(r31)
lbl_803D3A80:
/* 803D3A80 003CF720  80 1F 00 38 */	lwz r0, 0x38(r31)
/* 803D3A84 003CF724  54 00 07 7B */	rlwinm. r0, r0, 0, 0x1d, 0x1d
/* 803D3A88 003CF728  41 82 00 0C */	beq lbl_803D3A94
/* 803D3A8C 003CF72C  38 7F 00 20 */	addi r3, r31, 0x20
/* 803D3A90 003CF730  48 00 DC 95 */	bl "OSUnlockMutex"
lbl_803D3A94:
/* 803D3A94 003CF734  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 803D3A98 003CF738  7F A3 EB 78 */	mr r3, r29
/* 803D3A9C 003CF73C  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 803D3AA0 003CF740  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 803D3AA4 003CF744  80 01 00 24 */	lwz r0, 0x24(r1)
/* 803D3AA8 003CF748  7C 08 03 A6 */	mtlr r0
/* 803D3AAC 003CF74C  38 21 00 20 */	addi r1, r1, 0x20
/* 803D3AB0 003CF750  4E 80 00 20 */	blr 

.global "MEMFreeToFrmHeap"
"MEMFreeToFrmHeap":
/* 803D3AB4 003CF754  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 803D3AB8 003CF758  7C 08 02 A6 */	mflr r0
/* 803D3ABC 003CF75C  90 01 00 14 */	stw r0, 0x14(r1)
/* 803D3AC0 003CF760  93 E1 00 0C */	stw r31, 0xc(r1)
/* 803D3AC4 003CF764  7C 9F 23 78 */	mr r31, r4
/* 803D3AC8 003CF768  93 C1 00 08 */	stw r30, 8(r1)
/* 803D3ACC 003CF76C  7C 7E 1B 78 */	mr r30, r3
/* 803D3AD0 003CF770  80 03 00 38 */	lwz r0, 0x38(r3)
/* 803D3AD4 003CF774  54 00 07 7B */	rlwinm. r0, r0, 0, 0x1d, 0x1d
/* 803D3AD8 003CF778  41 82 00 0C */	beq lbl_803D3AE4
/* 803D3ADC 003CF77C  38 63 00 20 */	addi r3, r3, 0x20
/* 803D3AE0 003CF780  48 00 DB 69 */	bl "OSLockMutex"
lbl_803D3AE4:
/* 803D3AE4 003CF784  57 E0 07 FF */	clrlwi. r0, r31, 0x1f
/* 803D3AE8 003CF788  41 82 00 14 */	beq lbl_803D3AFC
/* 803D3AEC 003CF78C  80 7E 00 18 */	lwz r3, 0x18(r30)
/* 803D3AF0 003CF790  38 00 00 00 */	li r0, 0
/* 803D3AF4 003CF794  90 1E 00 44 */	stw r0, 0x44(r30)
/* 803D3AF8 003CF798  90 7E 00 3C */	stw r3, 0x3c(r30)
lbl_803D3AFC:
/* 803D3AFC 003CF79C  57 E0 07 BD */	rlwinm. r0, r31, 0, 0x1e, 0x1e
/* 803D3B00 003CF7A0  41 82 00 28 */	beq lbl_803D3B28
/* 803D3B04 003CF7A4  80 7E 00 44 */	lwz r3, 0x44(r30)
/* 803D3B08 003CF7A8  48 00 00 10 */	b lbl_803D3B18
lbl_803D3B0C:
/* 803D3B0C 003CF7AC  80 1E 00 1C */	lwz r0, 0x1c(r30)
/* 803D3B10 003CF7B0  90 03 00 08 */	stw r0, 8(r3)
/* 803D3B14 003CF7B4  80 63 00 0C */	lwz r3, 0xc(r3)
lbl_803D3B18:
/* 803D3B18 003CF7B8  2C 03 00 00 */	cmpwi r3, 0
/* 803D3B1C 003CF7BC  40 82 FF F0 */	bne lbl_803D3B0C
/* 803D3B20 003CF7C0  80 1E 00 1C */	lwz r0, 0x1c(r30)
/* 803D3B24 003CF7C4  90 1E 00 40 */	stw r0, 0x40(r30)
lbl_803D3B28:
/* 803D3B28 003CF7C8  80 1E 00 38 */	lwz r0, 0x38(r30)
/* 803D3B2C 003CF7CC  54 00 07 7B */	rlwinm. r0, r0, 0, 0x1d, 0x1d
/* 803D3B30 003CF7D0  41 82 00 0C */	beq lbl_803D3B3C
/* 803D3B34 003CF7D4  38 7E 00 20 */	addi r3, r30, 0x20
/* 803D3B38 003CF7D8  48 00 DB ED */	bl "OSUnlockMutex"
lbl_803D3B3C:
/* 803D3B3C 003CF7DC  80 01 00 14 */	lwz r0, 0x14(r1)
/* 803D3B40 003CF7E0  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 803D3B44 003CF7E4  83 C1 00 08 */	lwz r30, 8(r1)
/* 803D3B48 003CF7E8  7C 08 03 A6 */	mtlr r0
/* 803D3B4C 003CF7EC  38 21 00 10 */	addi r1, r1, 0x10
/* 803D3B50 003CF7F0  4E 80 00 20 */	blr 

.global "MEMGetAllocatableSizeForFrmHeapEx"
"MEMGetAllocatableSizeForFrmHeapEx":
/* 803D3B54 003CF7F4  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 803D3B58 003CF7F8  7C 08 02 A6 */	mflr r0
/* 803D3B5C 003CF7FC  90 01 00 14 */	stw r0, 0x14(r1)
/* 803D3B60 003CF800  7C 80 FE 70 */	srawi r0, r4, 0x1f
/* 803D3B64 003CF804  93 E1 00 0C */	stw r31, 0xc(r1)
/* 803D3B68 003CF808  7C 1F 22 78 */	xor r31, r0, r4
/* 803D3B6C 003CF80C  7F E0 F8 50 */	subf r31, r0, r31
/* 803D3B70 003CF810  93 C1 00 08 */	stw r30, 8(r1)
/* 803D3B74 003CF814  7C 7E 1B 78 */	mr r30, r3
/* 803D3B78 003CF818  48 00 C8 E5 */	bl "__RAS_OSDisableInterrupts_begin"
/* 803D3B7C 003CF81C  80 1E 00 3C */	lwz r0, 0x3c(r30)
/* 803D3B80 003CF820  38 9F FF FF */	addi r4, r31, -1
/* 803D3B84 003CF824  7C 85 20 F8 */	nor r5, r4, r4
/* 803D3B88 003CF828  80 DE 00 40 */	lwz r6, 0x40(r30)
/* 803D3B8C 003CF82C  7C 9F 02 14 */	add r4, r31, r0
/* 803D3B90 003CF830  38 04 FF FF */	addi r0, r4, -1
/* 803D3B94 003CF834  7C A0 00 38 */	and r0, r5, r0
/* 803D3B98 003CF838  7C 00 30 40 */	cmplw r0, r6
/* 803D3B9C 003CF83C  40 81 00 0C */	ble lbl_803D3BA8
/* 803D3BA0 003CF840  3B E0 00 00 */	li r31, 0
/* 803D3BA4 003CF844  48 00 00 08 */	b lbl_803D3BAC
lbl_803D3BA8:
/* 803D3BA8 003CF848  7F E0 30 50 */	subf r31, r0, r6
lbl_803D3BAC:
/* 803D3BAC 003CF84C  48 00 C8 D9 */	bl "OSRestoreInterrupts"
/* 803D3BB0 003CF850  7F E3 FB 78 */	mr r3, r31
/* 803D3BB4 003CF854  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 803D3BB8 003CF858  83 C1 00 08 */	lwz r30, 8(r1)
/* 803D3BBC 003CF85C  80 01 00 14 */	lwz r0, 0x14(r1)
/* 803D3BC0 003CF860  7C 08 03 A6 */	mtlr r0
/* 803D3BC4 003CF864  38 21 00 10 */	addi r1, r1, 0x10
/* 803D3BC8 003CF868  4E 80 00 20 */	blr 
