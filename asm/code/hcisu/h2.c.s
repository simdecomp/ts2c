.include "macros.inc"

.section .text, "ax"  # 0x80006940 - 0x80418B80
.global "hcisu_h2_usb_cback"
"hcisu_h2_usb_cback":
/* 8033CAE0 00338780  2C 03 00 04 */	cmpwi r3, 4
/* 8033CAE4 00338784  41 82 00 14 */	beq lbl_8033CAF8
/* 8033CAE8 00338788  4C 80 00 20 */	bgelr
/* 8033CAEC 0033878C  2C 03 00 00 */	cmpwi r3, 0
/* 8033CAF0 00338790  4D 82 00 20 */	beqlr
/* 8033CAF4 00338794  4E 80 00 20 */	blr
lbl_8033CAF8:
/* 8033CAF8 00338798  7C 83 07 74 */	extsb r3, r4
/* 8033CAFC 0033879C  48 00 1E CC */	b "bta_usb_close_evt"
/* 8033CB00 003387A0  4E 80 00 20 */	blr

.global "hcisu_h2_receive_msg"
"hcisu_h2_receive_msg":
/* 8033CB04 003387A4  94 21 FF A0 */	stwu r1, -0x60(r1)
/* 8033CB08 003387A8  7C 08 02 A6 */	mflr r0
/* 8033CB0C 003387AC  90 01 00 64 */	stw r0, 0x64(r1)
/* 8033CB10 003387B0  39 61 00 60 */	addi r11, r1, 0x60
/* 8033CB14 003387B4  48 0D 28 2D */	bl "_savegpr_14"
/* 8033CB18 003387B8  88 04 00 1E */	lbz r0, 0x1e(r4)
/* 8033CB1C 003387BC  7C 8F 23 78 */	mr r15, r4
/* 8033CB20 003387C0  3A 60 00 00 */	li r19, 0
/* 8033CB24 003387C4  28 00 00 02 */	cmplwi r0, 2
/* 8033CB28 003387C8  41 82 00 0C */	beq lbl_8033CB34
/* 8033CB2C 003387CC  38 60 00 00 */	li r3, 0
/* 8033CB30 003387D0  48 00 03 54 */	b lbl_8033CE84
lbl_8033CB34:
/* 8033CB34 003387D4  3A 83 00 01 */	addi r20, r3, 1
/* 8033CB38 003387D8  54 60 0B FC */	rlwinm r0, r3, 1, 0xf, 0x1e
/* 8033CB3C 003387DC  3F E0 80 58 */	lis r31, "hcisu_h2_cb"@ha
/* 8033CB40 003387E0  7E C4 1A 14 */	add r22, r4, r3
/* 8033CB44 003387E4  56 90 04 3E */	clrlwi r16, r20, 0x10
/* 8033CB48 003387E8  54 77 13 BA */	rlwinm r23, r3, 2, 0xe, 0x1d
/* 8033CB4C 003387EC  7E A4 02 14 */	add r21, r4, r0
/* 8033CB50 003387F0  3B FF 04 C0 */	addi r31, r31, "hcisu_h2_cb"@l
/* 8033CB54 003387F4  3B A0 00 00 */	li r29, 0
/* 8033CB58 003387F8  3B C0 00 04 */	li r30, 4
/* 8033CB5C 003387FC  3B 82 A5 30 */	addi r28, r2, "hcisu_preamble_table"-_SDA2_BASE_
/* 8033CB60 00338800  3B 20 00 03 */	li r25, 3
/* 8033CB64 00338804  3B 00 00 02 */	li r24, 2
/* 8033CB68 00338808  3D C0 80 46 */	lis r14, 0x8046
/* 8033CB6C 0033880C  3B 42 A5 38 */	addi r26, r2, "hcisu_msg_evt_table"-_SDA2_BASE_
/* 8033CB70 00338810  3B 60 00 01 */	li r27, 1
lbl_8033CB74:
/* 8033CB74 00338814  56 03 06 3E */	clrlwi r3, r16, 0x18
/* 8033CB78 00338818  38 81 00 08 */	addi r4, r1, 8
/* 8033CB7C 0033881C  38 A0 00 01 */	li r5, 1
/* 8033CB80 00338820  48 00 14 59 */	bl "UUSB_Read"
/* 8033CB84 00338824  54 60 04 3F */	clrlwi. r0, r3, 0x10
/* 8033CB88 00338828  41 82 02 F8 */	beq lbl_8033CE80
/* 8033CB8C 0033882C  88 16 00 1A */	lbz r0, 0x1a(r22)
/* 8033CB90 00338830  3A 20 00 00 */	li r17, 0
/* 8033CB94 00338834  3A 73 00 01 */	addi r19, r19, 1
/* 8033CB98 00338838  2C 00 00 02 */	cmpwi r0, 2
/* 8033CB9C 0033883C  41 82 01 C8 */	beq lbl_8033CD64
/* 8033CBA0 00338840  40 80 00 14 */	bge lbl_8033CBB4
/* 8033CBA4 00338844  2C 00 00 00 */	cmpwi r0, 0
/* 8033CBA8 00338848  41 82 00 1C */	beq lbl_8033CBC4
/* 8033CBAC 0033884C  40 80 00 C0 */	bge lbl_8033CC6C
/* 8033CBB0 00338850  48 00 02 B0 */	b lbl_8033CE60
lbl_8033CBB4:
/* 8033CBB4 00338854  2C 00 00 04 */	cmpwi r0, 4
/* 8033CBB8 00338858  41 82 02 90 */	beq lbl_8033CE48
/* 8033CBBC 0033885C  40 80 02 A4 */	bge lbl_8033CE60
/* 8033CBC0 00338860  48 00 01 F0 */	b lbl_8033CDB0
lbl_8033CBC4:
/* 8033CBC4 00338864  28 10 00 01 */	cmplwi r16, 1
/* 8033CBC8 00338868  40 82 00 18 */	bne lbl_8033CBE0
/* 8033CBCC 0033886C  38 60 00 02 */	li r3, 2
/* 8033CBD0 00338870  4B FF E9 65 */	bl "GKI_getpoolbuf"
/* 8033CBD4 00338874  7C 6F B9 2E */	stwx r3, r15, r23
/* 8033CBD8 00338878  9B D6 00 14 */	stb r30, 0x14(r22)
/* 8033CBDC 0033887C  48 00 00 38 */	b lbl_8033CC14
lbl_8033CBE0:
/* 8033CBE0 00338880  28 10 00 02 */	cmplwi r16, 2
/* 8033CBE4 00338884  40 82 00 18 */	bne lbl_8033CBFC
/* 8033CBE8 00338888  38 60 00 03 */	li r3, 3
/* 8033CBEC 0033888C  4B FF E9 49 */	bl "GKI_getpoolbuf"
/* 8033CBF0 00338890  7C 6F B9 2E */	stwx r3, r15, r23
/* 8033CBF4 00338894  9B 16 00 14 */	stb r24, 0x14(r22)
/* 8033CBF8 00338898  48 00 00 1C */	b lbl_8033CC14
lbl_8033CBFC:
/* 8033CBFC 0033889C  28 10 00 03 */	cmplwi r16, 3
/* 8033CC00 003388A0  40 82 02 60 */	bne lbl_8033CE60
/* 8033CC04 003388A4  38 60 00 01 */	li r3, 1
/* 8033CC08 003388A8  4B FF E9 2D */	bl "GKI_getpoolbuf"
/* 8033CC0C 003388AC  7C 6F B9 2E */	stwx r3, r15, r23
/* 8033CC10 003388B0  9B 36 00 14 */	stb r25, 0x14(r22)
lbl_8033CC14:
/* 8033CC14 003388B4  7C 6F B8 2E */	lwzx r3, r15, r23
/* 8033CC18 003388B8  2C 03 00 00 */	cmpwi r3, 0
/* 8033CC1C 003388BC  41 82 00 30 */	beq lbl_8033CC4C
/* 8033CC20 003388C0  B3 A3 00 02 */	sth r29, 2(r3)
/* 8033CC24 003388C4  88 16 00 14 */	lbz r0, 0x14(r22)
/* 8033CC28 003388C8  7C 6F B8 2E */	lwzx r3, r15, r23
/* 8033CC2C 003388CC  54 00 08 3C */	slwi r0, r0, 1
/* 8033CC30 003388D0  7C 9A 02 14 */	add r4, r26, r0
/* 8033CC34 003388D4  A0 04 FF FE */	lhz r0, -2(r4)
/* 8033CC38 003388D8  B0 03 00 00 */	sth r0, 0(r3)
/* 8033CC3C 003388DC  7C 6F B8 2E */	lwzx r3, r15, r23
/* 8033CC40 003388E0  B3 A3 00 04 */	sth r29, 4(r3)
/* 8033CC44 003388E4  9B 76 00 1A */	stb r27, 0x1a(r22)
/* 8033CC48 003388E8  48 00 00 14 */	b lbl_8033CC5C
lbl_8033CC4C:
/* 8033CC4C 003388EC  38 8E FD 80 */	addi r4, r14, -640
/* 8033CC50 003388F0  3C 60 00 07 */	lis r3, 7
/* 8033CC54 003388F4  48 00 1B A5 */	bl "LogMsg_0"
/* 8033CC58 003388F8  9B 16 00 1A */	stb r24, 0x1a(r22)
lbl_8033CC5C:
/* 8033CC5C 003388FC  88 16 00 14 */	lbz r0, 0x14(r22)
/* 8033CC60 00338900  7C 7C 02 14 */	add r3, r28, r0
/* 8033CC64 00338904  88 03 FF FF */	lbz r0, -1(r3)
/* 8033CC68 00338908  B0 15 00 0C */	sth r0, 0xc(r21)
lbl_8033CC6C:
/* 8033CC6C 0033890C  7C CF B8 2E */	lwzx r6, r15, r23
/* 8033CC70 00338910  88 A1 00 08 */	lbz r5, 8(r1)
/* 8033CC74 00338914  A0 86 00 02 */	lhz r4, 2(r6)
/* 8033CC78 00338918  7C 66 22 14 */	add r3, r6, r4
/* 8033CC7C 0033891C  38 04 00 01 */	addi r0, r4, 1
/* 8033CC80 00338920  98 A3 00 08 */	stb r5, 8(r3)
/* 8033CC84 00338924  B0 06 00 02 */	sth r0, 2(r6)
/* 8033CC88 00338928  A0 75 00 0C */	lhz r3, 0xc(r21)
/* 8033CC8C 0033892C  38 63 FF FF */	addi r3, r3, -1
/* 8033CC90 00338930  54 60 04 3F */	clrlwi. r0, r3, 0x10
/* 8033CC94 00338934  B0 75 00 0C */	sth r3, 0xc(r21)
/* 8033CC98 00338938  40 82 00 C0 */	bne lbl_8033CD58
/* 8033CC9C 0033893C  88 16 00 14 */	lbz r0, 0x14(r22)
/* 8033CCA0 00338940  8A 41 00 08 */	lbz r18, 8(r1)
/* 8033CCA4 00338944  28 00 00 02 */	cmplwi r0, 2
/* 8033CCA8 00338948  40 82 00 44 */	bne lbl_8033CCEC
/* 8033CCAC 0033894C  88 16 00 17 */	lbz r0, 0x17(r22)
/* 8033CCB0 00338950  56 44 42 2E */	rlwinm r4, r18, 8, 8, 0x17
/* 8033CCB4 00338954  7C 6F B8 2E */	lwzx r3, r15, r23
/* 8033CCB8 00338958  7C 04 02 14 */	add r0, r4, r0
/* 8033CCBC 0033895C  54 12 04 3E */	clrlwi r18, r0, 0x10
/* 8033CCC0 00338960  48 01 D2 45 */	bl "l2cap_link_chk_pkt_start"
/* 8033CCC4 00338964  2C 03 00 00 */	cmpwi r3, 0
/* 8033CCC8 00338968  7C 6F B9 2E */	stwx r3, r15, r23
/* 8033CCCC 0033896C  40 82 00 20 */	bne lbl_8033CCEC
/* 8033CCD0 00338970  2C 12 00 00 */	cmpwi r18, 0
/* 8033CCD4 00338974  B2 55 00 0C */	sth r18, 0xc(r21)
/* 8033CCD8 00338978  40 82 00 0C */	bne lbl_8033CCE4
/* 8033CCDC 0033897C  9B B6 00 1A */	stb r29, 0x1a(r22)
/* 8033CCE0 00338980  48 00 01 80 */	b lbl_8033CE60
lbl_8033CCE4:
/* 8033CCE4 00338984  9B D6 00 1A */	stb r30, 0x1a(r22)
/* 8033CCE8 00338988  48 00 01 78 */	b lbl_8033CE60
lbl_8033CCEC:
/* 8033CCEC 0033898C  B2 55 00 0C */	sth r18, 0xc(r21)
/* 8033CCF0 00338990  7C 6F B8 2E */	lwzx r3, r15, r23
/* 8033CCF4 00338994  4B FF EA 99 */	bl "GKI_get_buf_size"
/* 8033CCF8 00338998  88 16 00 14 */	lbz r0, 0x14(r22)
/* 8033CCFC 0033899C  54 64 04 3E */	clrlwi r4, r3, 0x10
/* 8033CD00 003389A0  7C 7C 02 14 */	add r3, r28, r0
/* 8033CD04 003389A4  88 03 FF FF */	lbz r0, -1(r3)
/* 8033CD08 003389A8  7C 72 02 14 */	add r3, r18, r0
/* 8033CD0C 003389AC  38 03 00 08 */	addi r0, r3, 8
/* 8033CD10 003389B0  7C 00 20 40 */	cmplw r0, r4
/* 8033CD14 003389B4  40 81 00 28 */	ble lbl_8033CD3C
/* 8033CD18 003389B8  7C 6F B8 2E */	lwzx r3, r15, r23
/* 8033CD1C 003389BC  4B FF E9 01 */	bl "GKI_freebuf"
/* 8033CD20 003389C0  7F AF B9 2E */	stwx r29, r15, r23
/* 8033CD24 003389C4  3C 60 80 46 */	lis r3, lbl_8045FDBC@ha
/* 8033CD28 003389C8  38 83 FD BC */	addi r4, r3, lbl_8045FDBC@l
/* 8033CD2C 003389CC  9B D6 00 1A */	stb r30, 0x1a(r22)
/* 8033CD30 003389D0  3C 60 00 07 */	lis r3, 7
/* 8033CD34 003389D4  48 00 1A C5 */	bl "LogMsg_0"
/* 8033CD38 003389D8  48 00 01 28 */	b lbl_8033CE60
lbl_8033CD3C:
/* 8033CD3C 003389DC  2C 12 00 00 */	cmpwi r18, 0
/* 8033CD40 003389E0  41 82 00 0C */	beq lbl_8033CD4C
/* 8033CD44 003389E4  9B 36 00 1A */	stb r25, 0x1a(r22)
/* 8033CD48 003389E8  48 00 01 18 */	b lbl_8033CE60
lbl_8033CD4C:
/* 8033CD4C 003389EC  9B B6 00 1A */	stb r29, 0x1a(r22)
/* 8033CD50 003389F0  3A 20 00 01 */	li r17, 1
/* 8033CD54 003389F4  48 00 01 0C */	b lbl_8033CE60
lbl_8033CD58:
/* 8033CD58 003389F8  88 01 00 08 */	lbz r0, 8(r1)
/* 8033CD5C 003389FC  98 16 00 17 */	stb r0, 0x17(r22)
/* 8033CD60 00338A00  48 00 01 00 */	b lbl_8033CE60
lbl_8033CD64:
/* 8033CD64 00338A04  A0 75 00 0C */	lhz r3, 0xc(r21)
/* 8033CD68 00338A08  38 63 FF FF */	addi r3, r3, -1
/* 8033CD6C 00338A0C  54 60 04 3F */	clrlwi. r0, r3, 0x10
/* 8033CD70 00338A10  B0 75 00 0C */	sth r3, 0xc(r21)
/* 8033CD74 00338A14  40 82 00 30 */	bne lbl_8033CDA4
/* 8033CD78 00338A18  88 16 00 14 */	lbz r0, 0x14(r22)
/* 8033CD7C 00338A1C  88 61 00 08 */	lbz r3, 8(r1)
/* 8033CD80 00338A20  28 00 00 02 */	cmplwi r0, 2
/* 8033CD84 00338A24  40 82 00 14 */	bne lbl_8033CD98
/* 8033CD88 00338A28  88 16 00 17 */	lbz r0, 0x17(r22)
/* 8033CD8C 00338A2C  54 63 42 2E */	rlwinm r3, r3, 8, 8, 0x17
/* 8033CD90 00338A30  7C 03 02 14 */	add r0, r3, r0
/* 8033CD94 00338A34  54 03 04 3E */	clrlwi r3, r0, 0x10
lbl_8033CD98:
/* 8033CD98 00338A38  B0 75 00 0C */	sth r3, 0xc(r21)
/* 8033CD9C 00338A3C  9B D6 00 1A */	stb r30, 0x1a(r22)
/* 8033CDA0 00338A40  48 00 00 C0 */	b lbl_8033CE60
lbl_8033CDA4:
/* 8033CDA4 00338A44  88 01 00 08 */	lbz r0, 8(r1)
/* 8033CDA8 00338A48  98 16 00 17 */	stb r0, 0x17(r22)
/* 8033CDAC 00338A4C  48 00 00 B4 */	b lbl_8033CE60
lbl_8033CDB0:
/* 8033CDB0 00338A50  7C EF B8 2E */	lwzx r7, r15, r23
/* 8033CDB4 00338A54  56 83 06 3E */	clrlwi r3, r20, 0x18
/* 8033CDB8 00338A58  88 C1 00 08 */	lbz r6, 8(r1)
/* 8033CDBC 00338A5C  A0 A7 00 02 */	lhz r5, 2(r7)
/* 8033CDC0 00338A60  7C 87 2A 14 */	add r4, r7, r5
/* 8033CDC4 00338A64  38 05 00 01 */	addi r0, r5, 1
/* 8033CDC8 00338A68  98 C4 00 08 */	stb r6, 8(r4)
/* 8033CDCC 00338A6C  B0 07 00 02 */	sth r0, 2(r7)
/* 8033CDD0 00338A70  A0 95 00 0C */	lhz r4, 0xc(r21)
/* 8033CDD4 00338A74  38 04 FF FF */	addi r0, r4, -1
/* 8033CDD8 00338A78  B0 15 00 0C */	sth r0, 0xc(r21)
/* 8033CDDC 00338A7C  54 05 04 3E */	clrlwi r5, r0, 0x10
/* 8033CDE0 00338A80  7C 8F B8 2E */	lwzx r4, r15, r23
/* 8033CDE4 00338A84  A0 04 00 02 */	lhz r0, 2(r4)
/* 8033CDE8 00338A88  7C 84 02 14 */	add r4, r4, r0
/* 8033CDEC 00338A8C  38 84 00 08 */	addi r4, r4, 8
/* 8033CDF0 00338A90  48 00 11 E9 */	bl "UUSB_Read"
/* 8033CDF4 00338A94  7C 8F B8 2E */	lwzx r4, r15, r23
/* 8033CDF8 00338A98  7E 73 1A 14 */	add r19, r19, r3
/* 8033CDFC 00338A9C  A0 04 00 02 */	lhz r0, 2(r4)
/* 8033CE00 00338AA0  7C 00 1A 14 */	add r0, r0, r3
/* 8033CE04 00338AA4  B0 04 00 02 */	sth r0, 2(r4)
/* 8033CE08 00338AA8  A0 15 00 0C */	lhz r0, 0xc(r21)
/* 8033CE0C 00338AAC  7C 63 00 50 */	subf r3, r3, r0
/* 8033CE10 00338AB0  54 60 04 3F */	clrlwi. r0, r3, 0x10
/* 8033CE14 00338AB4  B0 75 00 0C */	sth r3, 0xc(r21)
/* 8033CE18 00338AB8  40 82 00 48 */	bne lbl_8033CE60
/* 8033CE1C 00338ABC  88 16 00 14 */	lbz r0, 0x14(r22)
/* 8033CE20 00338AC0  28 00 00 02 */	cmplwi r0, 2
/* 8033CE24 00338AC4  40 82 00 18 */	bne lbl_8033CE3C
/* 8033CE28 00338AC8  48 01 D2 AD */	bl "l2cap_link_chk_pkt_end"
/* 8033CE2C 00338ACC  54 60 06 3F */	clrlwi. r0, r3, 0x18
/* 8033CE30 00338AD0  40 82 00 0C */	bne lbl_8033CE3C
/* 8033CE34 00338AD4  9B B6 00 1A */	stb r29, 0x1a(r22)
/* 8033CE38 00338AD8  48 00 00 28 */	b lbl_8033CE60
lbl_8033CE3C:
/* 8033CE3C 00338ADC  9B B6 00 1A */	stb r29, 0x1a(r22)
/* 8033CE40 00338AE0  3A 20 00 01 */	li r17, 1
/* 8033CE44 00338AE4  48 00 00 1C */	b lbl_8033CE60
lbl_8033CE48:
/* 8033CE48 00338AE8  A0 75 00 0C */	lhz r3, 0xc(r21)
/* 8033CE4C 00338AEC  38 63 FF FF */	addi r3, r3, -1
/* 8033CE50 00338AF0  54 60 04 3F */	clrlwi. r0, r3, 0x10
/* 8033CE54 00338AF4  B0 75 00 0C */	sth r3, 0xc(r21)
/* 8033CE58 00338AF8  40 82 00 08 */	bne lbl_8033CE60
/* 8033CE5C 00338AFC  9B B6 00 1A */	stb r29, 0x1a(r22)
lbl_8033CE60:
/* 8033CE60 00338B00  2C 11 00 00 */	cmpwi r17, 0
/* 8033CE64 00338B04  41 82 FD 10 */	beq lbl_8033CB74
/* 8033CE68 00338B08  88 7F 00 1F */	lbz r3, 0x1f(r31)
/* 8033CE6C 00338B0C  38 80 00 00 */	li r4, 0
/* 8033CE70 00338B10  7C AF B8 2E */	lwzx r5, r15, r23
/* 8033CE74 00338B14  4B FF E9 5D */	bl "GKI_send_msg"
/* 8033CE78 00338B18  7F AF B9 2E */	stwx r29, r15, r23
/* 8033CE7C 00338B1C  4B FF FC F8 */	b lbl_8033CB74
lbl_8033CE80:
/* 8033CE80 00338B20  7E 63 9B 78 */	mr r3, r19
lbl_8033CE84:
/* 8033CE84 00338B24  39 61 00 60 */	addi r11, r1, 0x60
/* 8033CE88 00338B28  48 0D 25 05 */	bl "_restgpr_14"
/* 8033CE8C 00338B2C  80 01 00 64 */	lwz r0, 0x64(r1)
/* 8033CE90 00338B30  7C 08 03 A6 */	mtlr r0
/* 8033CE94 00338B34  38 21 00 60 */	addi r1, r1, 0x60
/* 8033CE98 00338B38  4E 80 00 20 */	blr

.global "hcisu_h2_send_msg_now"
"hcisu_h2_send_msg_now":
/* 8033CE9C 00338B3C  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 8033CEA0 00338B40  7C 08 02 A6 */	mflr r0
/* 8033CEA4 00338B44  90 01 00 24 */	stw r0, 0x24(r1)
/* 8033CEA8 00338B48  39 61 00 20 */	addi r11, r1, 0x20
/* 8033CEAC 00338B4C  48 0D 24 C9 */	bl "_savegpr_27"
/* 8033CEB0 00338B50  A0 A4 00 00 */	lhz r5, 0(r4)
/* 8033CEB4 00338B54  7C 9B 23 78 */	mr r27, r4
/* 8033CEB8 00338B58  A0 04 00 04 */	lhz r0, 4(r4)
/* 8033CEBC 00338B5C  28 05 21 00 */	cmplwi r5, 0x2100
/* 8033CEC0 00338B60  7C 64 02 14 */	add r3, r4, r0
/* 8033CEC4 00338B64  38 C3 00 08 */	addi r6, r3, 8
/* 8033CEC8 00338B68  40 82 00 0C */	bne lbl_8033CED4
/* 8033CECC 00338B6C  3B 80 00 02 */	li r28, 2
/* 8033CED0 00338B70  48 00 00 20 */	b lbl_8033CEF0
lbl_8033CED4:
/* 8033CED4 00338B74  28 05 22 00 */	cmplwi r5, 0x2200
/* 8033CED8 00338B78  40 82 00 0C */	bne lbl_8033CEE4
/* 8033CEDC 00338B7C  3B 80 00 03 */	li r28, 3
/* 8033CEE0 00338B80  48 00 00 10 */	b lbl_8033CEF0
lbl_8033CEE4:
/* 8033CEE4 00338B84  28 05 20 00 */	cmplwi r5, 0x2000
/* 8033CEE8 00338B88  40 82 00 08 */	bne lbl_8033CEF0
/* 8033CEEC 00338B8C  3B 80 00 00 */	li r28, 0
lbl_8033CEF0:
/* 8033CEF0 00338B90  28 05 21 00 */	cmplwi r5, 0x2100
/* 8033CEF4 00338B94  40 82 01 20 */	bne lbl_8033D014
/* 8033CEF8 00338B98  3C 60 80 58 */	lis r3, "btu_cb"@ha
/* 8033CEFC 00338B9C  A0 84 00 02 */	lhz r4, 2(r4)
/* 8033CF00 00338BA0  3B C3 3D 70 */	addi r30, r3, "btu_cb"@l
/* 8033CF04 00338BA4  A0 1E 00 7E */	lhz r0, 0x7e(r30)
/* 8033CF08 00338BA8  7C 04 00 40 */	cmplw r4, r0
/* 8033CF0C 00338BAC  40 81 01 08 */	ble lbl_8033D014
/* 8033CF10 00338BB0  88 06 00 01 */	lbz r0, 1(r6)
/* 8033CF14 00338BB4  88 66 00 00 */	lbz r3, 0(r6)
/* 8033CF18 00338BB8  38 C6 00 02 */	addi r6, r6, 2
/* 8033CF1C 00338BBC  54 00 44 2E */	rlwinm r0, r0, 8, 0x10, 0x17
/* 8033CF20 00338BC0  7C 03 02 14 */	add r0, r3, r0
/* 8033CF24 00338BC4  54 00 04 3E */	clrlwi r0, r0, 0x10
/* 8033CF28 00338BC8  70 00 CF FF */	andi. r0, r0, 0xcfff
/* 8033CF2C 00338BCC  60 1F 10 00 */	ori r31, r0, 0x1000
/* 8033CF30 00338BD0  7F FD 46 70 */	srawi r29, r31, 8
/* 8033CF34 00338BD4  48 00 00 D0 */	b lbl_8033D004
lbl_8033CF38:
/* 8033CF38 00338BD8  7C C4 33 78 */	mr r4, r6
/* 8033CF3C 00338BDC  7F 83 E3 78 */	mr r3, r28
/* 8033CF40 00338BE0  7F 66 DB 78 */	mr r6, r27
/* 8033CF44 00338BE4  48 00 10 9D */	bl "UUSB_Write"
/* 8033CF48 00338BE8  A0 7B 00 04 */	lhz r3, 4(r27)
/* 8033CF4C 00338BEC  A0 1E 00 7C */	lhz r0, 0x7c(r30)
/* 8033CF50 00338BF0  A0 9B 00 02 */	lhz r4, 2(r27)
/* 8033CF54 00338BF4  7C 03 02 14 */	add r0, r3, r0
/* 8033CF58 00338BF8  B0 1B 00 04 */	sth r0, 4(r27)
/* 8033CF5C 00338BFC  54 00 04 3E */	clrlwi r0, r0, 0x10
/* 8033CF60 00338C00  7C 7B 02 14 */	add r3, r27, r0
/* 8033CF64 00338C04  A0 1E 00 7C */	lhz r0, 0x7c(r30)
/* 8033CF68 00338C08  38 C3 00 0A */	addi r6, r3, 0xa
/* 8033CF6C 00338C0C  7C 00 20 50 */	subf r0, r0, r4
/* 8033CF70 00338C10  B0 1B 00 02 */	sth r0, 2(r27)
/* 8033CF74 00338C14  9B E3 00 08 */	stb r31, 8(r3)
/* 8033CF78 00338C18  9B A3 00 09 */	stb r29, 9(r3)
/* 8033CF7C 00338C1C  A0 7B 00 02 */	lhz r3, 2(r27)
/* 8033CF80 00338C20  A0 1E 00 7E */	lhz r0, 0x7e(r30)
/* 8033CF84 00338C24  7C 03 00 40 */	cmplw r3, r0
/* 8033CF88 00338C28  40 81 00 20 */	ble lbl_8033CFA8
/* 8033CF8C 00338C2C  A0 1E 00 7C */	lhz r0, 0x7c(r30)
/* 8033CF90 00338C30  98 06 00 00 */	stb r0, 0(r6)
/* 8033CF94 00338C34  A0 1E 00 7C */	lhz r0, 0x7c(r30)
/* 8033CF98 00338C38  7C 00 46 70 */	srawi r0, r0, 8
/* 8033CF9C 00338C3C  98 06 00 01 */	stb r0, 1(r6)
/* 8033CFA0 00338C40  38 C6 00 02 */	addi r6, r6, 2
/* 8033CFA4 00338C44  48 00 00 20 */	b lbl_8033CFC4
lbl_8033CFA8:
/* 8033CFA8 00338C48  38 03 FF FC */	addi r0, r3, -4
/* 8033CFAC 00338C4C  98 06 00 00 */	stb r0, 0(r6)
/* 8033CFB0 00338C50  A0 7B 00 02 */	lhz r3, 2(r27)
/* 8033CFB4 00338C54  38 03 FF FC */	addi r0, r3, -4
/* 8033CFB8 00338C58  7C 00 46 70 */	srawi r0, r0, 8
/* 8033CFBC 00338C5C  98 06 00 01 */	stb r0, 1(r6)
/* 8033CFC0 00338C60  38 C6 00 02 */	addi r6, r6, 2
lbl_8033CFC4:
/* 8033CFC4 00338C64  A0 7B 00 06 */	lhz r3, 6(r27)
/* 8033CFC8 00338C68  2C 03 00 00 */	cmpwi r3, 0
/* 8033CFCC 00338C6C  41 82 00 38 */	beq lbl_8033D004
/* 8033CFD0 00338C70  38 63 FF FF */	addi r3, r3, -1
/* 8033CFD4 00338C74  54 60 04 3F */	clrlwi. r0, r3, 0x10
/* 8033CFD8 00338C78  B0 7B 00 06 */	sth r3, 6(r27)
/* 8033CFDC 00338C7C  40 82 00 28 */	bne lbl_8033D004
/* 8033CFE0 00338C80  38 00 19 00 */	li r0, 0x1900
/* 8033CFE4 00338C84  3C 60 80 58 */	lis r3, "hcisu_h2_cb"@ha
/* 8033CFE8 00338C88  B0 1B 00 00 */	sth r0, 0(r27)
/* 8033CFEC 00338C8C  38 63 04 C0 */	addi r3, r3, "hcisu_h2_cb"@l
/* 8033CFF0 00338C90  7F 65 DB 78 */	mr r5, r27
/* 8033CFF4 00338C94  38 80 00 00 */	li r4, 0
/* 8033CFF8 00338C98  88 63 00 1F */	lbz r3, 0x1f(r3)
/* 8033CFFC 00338C9C  4B FF E7 D5 */	bl "GKI_send_msg"
/* 8033D000 00338CA0  48 00 00 30 */	b lbl_8033D030
lbl_8033D004:
/* 8033D004 00338CA4  A0 BE 00 7E */	lhz r5, 0x7e(r30)
/* 8033D008 00338CA8  A0 1B 00 02 */	lhz r0, 2(r27)
/* 8033D00C 00338CAC  7C 00 28 40 */	cmplw r0, r5
/* 8033D010 00338CB0  41 81 FF 28 */	bgt lbl_8033CF38
lbl_8033D014:
/* 8033D014 00338CB4  A0 BB 00 02 */	lhz r5, 2(r27)
/* 8033D018 00338CB8  7C C4 33 78 */	mr r4, r6
/* 8033D01C 00338CBC  7F 83 E3 78 */	mr r3, r28
/* 8033D020 00338CC0  7F 66 DB 78 */	mr r6, r27
/* 8033D024 00338CC4  48 00 0F BD */	bl "UUSB_Write"
/* 8033D028 00338CC8  7F 63 DB 78 */	mr r3, r27
/* 8033D02C 00338CCC  4B FF E5 F1 */	bl "GKI_freebuf"
lbl_8033D030:
/* 8033D030 00338CD0  39 61 00 20 */	addi r11, r1, 0x20
/* 8033D034 00338CD4  48 0D 23 8D */	bl "_restgpr_27"
/* 8033D038 00338CD8  80 01 00 24 */	lwz r0, 0x24(r1)
/* 8033D03C 00338CDC  7C 08 03 A6 */	mtlr r0
/* 8033D040 00338CE0  38 21 00 20 */	addi r1, r1, 0x20
/* 8033D044 00338CE4  4E 80 00 20 */	blr

.global "hcisu_h2_init"
"hcisu_h2_init":
/* 8033D048 00338CE8  3C C0 80 58 */	lis r6, "hcisu_h2_cb"@ha
/* 8033D04C 00338CEC  38 00 00 00 */	li r0, 0
/* 8033D050 00338CF0  38 C6 04 C0 */	addi r6, r6, "hcisu_h2_cb"@l
/* 8033D054 00338CF4  98 06 00 1E */	stb r0, 0x1e(r6)
/* 8033D058 00338CF8  98 06 00 1A */	stb r0, 0x1a(r6)
/* 8033D05C 00338CFC  98 06 00 1B */	stb r0, 0x1b(r6)
/* 8033D060 00338D00  98 06 00 1C */	stb r0, 0x1c(r6)
/* 8033D064 00338D04  98 66 00 1F */	stb r3, 0x1f(r6)
/* 8033D068 00338D08  98 86 00 20 */	stb r4, 0x20(r6)
/* 8033D06C 00338D0C  B0 A6 00 12 */	sth r5, 0x12(r6)
/* 8033D070 00338D10  4E 80 00 20 */	blr

.global "hcisu_h2_open"
"hcisu_h2_open":
/* 8033D074 00338D14  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 8033D078 00338D18  7C 08 02 A6 */	mflr r0
/* 8033D07C 00338D1C  3C A0 80 58 */	lis r5, "hcisu_h2_cb"@ha
/* 8033D080 00338D20  90 01 00 24 */	stw r0, 0x24(r1)
/* 8033D084 00338D24  38 00 00 00 */	li r0, 0
/* 8033D088 00338D28  38 A5 04 C0 */	addi r5, r5, "hcisu_h2_cb"@l
/* 8033D08C 00338D2C  98 01 00 13 */	stb r0, 0x13(r1)
/* 8033D090 00338D30  38 00 00 02 */	li r0, 2
/* 8033D094 00338D34  88 85 00 1F */	lbz r4, 0x1f(r5)
/* 8033D098 00338D38  A0 C3 00 00 */	lhz r6, 0(r3)
/* 8033D09C 00338D3C  B0 C1 00 0C */	sth r6, 0xc(r1)
/* 8033D0A0 00338D40  A0 C3 00 02 */	lhz r6, 2(r3)
/* 8033D0A4 00338D44  38 61 00 08 */	addi r3, r1, 8
/* 8033D0A8 00338D48  B0 C1 00 0E */	sth r6, 0xe(r1)
/* 8033D0AC 00338D4C  B0 81 00 10 */	sth r4, 0x10(r1)
/* 8033D0B0 00338D50  98 05 00 1E */	stb r0, 0x1e(r5)
/* 8033D0B4 00338D54  48 00 0B A1 */	bl "UUSB_Register"
/* 8033D0B8 00338D58  3C 80 80 34 */	lis r4, "hcisu_h2_usb_cback"@ha
/* 8033D0BC 00338D5C  38 61 00 08 */	addi r3, r1, 8
/* 8033D0C0 00338D60  38 84 CA E0 */	addi r4, r4, "hcisu_h2_usb_cback"@l
/* 8033D0C4 00338D64  48 00 0D FD */	bl "UUSB_Open"
/* 8033D0C8 00338D68  80 01 00 24 */	lwz r0, 0x24(r1)
/* 8033D0CC 00338D6C  38 60 00 01 */	li r3, 1
/* 8033D0D0 00338D70  7C 08 03 A6 */	mtlr r0
/* 8033D0D4 00338D74  38 21 00 20 */	addi r1, r1, 0x20
/* 8033D0D8 00338D78  4E 80 00 20 */	blr

.global "hcisu_h2_close"
"hcisu_h2_close":
/* 8033D0DC 00338D7C  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 8033D0E0 00338D80  7C 08 02 A6 */	mflr r0
/* 8033D0E4 00338D84  3C 60 80 58 */	lis r3, "hcisu_h2_cb"@ha
/* 8033D0E8 00338D88  90 01 00 14 */	stw r0, 0x14(r1)
/* 8033D0EC 00338D8C  38 00 00 00 */	li r0, 0
/* 8033D0F0 00338D90  38 63 04 C0 */	addi r3, r3, "hcisu_h2_cb"@l
/* 8033D0F4 00338D94  98 03 00 1E */	stb r0, 0x1e(r3)
/* 8033D0F8 00338D98  48 00 14 71 */	bl "UUSB_Close"
/* 8033D0FC 00338D9C  48 00 15 19 */	bl "UUSB_Unregister"
/* 8033D100 00338DA0  80 01 00 14 */	lwz r0, 0x14(r1)
/* 8033D104 00338DA4  7C 08 03 A6 */	mtlr r0
/* 8033D108 00338DA8  38 21 00 10 */	addi r1, r1, 0x10
/* 8033D10C 00338DAC  4E 80 00 20 */	blr

.global "hcisu_h2_send"
"hcisu_h2_send":
/* 8033D110 00338DB0  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 8033D114 00338DB4  7C 08 02 A6 */	mflr r0
/* 8033D118 00338DB8  3C A0 80 58 */	lis r5, "hcisu_h2_cb"@ha
/* 8033D11C 00338DBC  7C 64 1B 78 */	mr r4, r3
/* 8033D120 00338DC0  90 01 00 14 */	stw r0, 0x14(r1)
/* 8033D124 00338DC4  38 65 04 C0 */	addi r3, r5, "hcisu_h2_cb"@l
/* 8033D128 00338DC8  4B FF FD 75 */	bl "hcisu_h2_send_msg_now"
/* 8033D12C 00338DCC  80 01 00 14 */	lwz r0, 0x14(r1)
/* 8033D130 00338DD0  38 60 00 01 */	li r3, 1
/* 8033D134 00338DD4  7C 08 03 A6 */	mtlr r0
/* 8033D138 00338DD8  38 21 00 10 */	addi r1, r1, 0x10
/* 8033D13C 00338DDC  4E 80 00 20 */	blr

.global "hcisu_h2_handle_event"
"hcisu_h2_handle_event":
/* 8033D140 00338DE0  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 8033D144 00338DE4  7C 08 02 A6 */	mflr r0
/* 8033D148 00338DE8  3C 80 80 58 */	lis r4, "hcisu_h2_cb"@ha
/* 8033D14C 00338DEC  90 01 00 14 */	stw r0, 0x14(r1)
/* 8033D150 00338DF0  38 84 04 C0 */	addi r4, r4, "hcisu_h2_cb"@l
/* 8033D154 00338DF4  38 03 FF F8 */	addi r0, r3, -8
/* 8033D158 00338DF8  A0 64 00 12 */	lhz r3, 0x12(r4)
/* 8033D15C 00338DFC  7C 03 00 50 */	subf r0, r3, r0
/* 8033D160 00338E00  54 03 04 3E */	clrlwi r3, r0, 0x10
/* 8033D164 00338E04  4B FF F9 A1 */	bl "hcisu_h2_receive_msg"
/* 8033D168 00338E08  80 01 00 14 */	lwz r0, 0x14(r1)
/* 8033D16C 00338E0C  38 60 00 00 */	li r3, 0
/* 8033D170 00338E10  7C 08 03 A6 */	mtlr r0
/* 8033D174 00338E14  38 21 00 10 */	addi r1, r1, 0x10
/* 8033D178 00338E18  4E 80 00 20 */	blr

.section .rodata, "a"  # 0x80418C80 - 0x80420060
.global "hcisu_h2"
"hcisu_h2":
	# ROM: 0x418870
	.4byte "hcisu_h2_init" ;# ptr (0x8033D048)
	.4byte "hcisu_h2_open" ;# ptr (0x8033D074)
	.4byte "hcisu_h2_close" ;# ptr (0x8033D0DC)
	.4byte "hcisu_h2_send" ;# ptr (0x8033D110)
	.4byte "hcisu_h2_handle_event" ;# ptr (0x8033D140)
	.4byte 0x00000000


.section .data, "wa"  # 0x80420060 - 0x80488160
	# ROM: 0x45BE80
	.asciz "HCIS: Unable to allocate buffer for incoming HCI message."
	.byte 0x00, 0x00

.global lbl_8045FDBC
lbl_8045FDBC:
	# ROM: 0x45BEBC
	.asciz "HCIS: Invalid length for incoming HCI message."
	.byte 0x00
	.4byte 0x00000000


.section .bss, "wa"  # 0x80488180 - 0x805DC448
.global "hcisu_h2_cb"
"hcisu_h2_cb":
	.skip 0x40

.section .sdata2, "a"  # 0x805D9220 - 0x805DC420
.global "hcisu_preamble_table"
"hcisu_preamble_table":
	# ROM: 0x489A70
	.4byte 0x03040302
	.4byte 0x00000000

.global "hcisu_msg_evt_table"
"hcisu_msg_evt_table":
	# ROM: 0x489A78
	.4byte 0x13001100
	.4byte 0x12001000

